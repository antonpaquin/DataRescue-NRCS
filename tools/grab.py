import requests

baseURL = "https://wcc.sc.egov.usda.gov/reportGenerator/view_csv/customSingleStationReport/daily/"
idString = "%7Cid=%22%22%7Cname/POR_BEGIN,POR_END/stationId,TMAX::value,TMIN::value,PRCP::value,RHUM::value:hourly%20MEAN,WSPDX::value:hourly%20MAX,WSPDV::value:hourly%20MEAN,SRADV::value:hourly%20MEAN,LRADT::value,PVPV::value:hourly%20MEAN,SVPV::value:hourly%20MEAN,SMS:-2:value:hourly%20MEAN,SMS:-4:value:hourly%20MEAN,SMS:-8:value:hourly%20MEAN,SMS:-20:value:hourly%20MEAN,SMS:-40:value:hourly%20MEAN,STO:-2:value:hourly%20MEAN,STO:-4:value:hourly%20MEAN,STO:-8:value:hourly%20MEAN,STO:-20:value:hourly%20MEAN,STO:-40:value:hourly%20MEAN"

def stationString(stationNum, stationState):
    return str(stationNum) + ':' + stationState + ':SCAN'

def getUrl(station):
    return baseURL + stationString(station[0], station[1]) + idString

def run(station):
    fname = station[1] + '_' + str(station[0]) + '.txt'
    url = getUrl(station)
    try:
        r = requests.get(url)
    except Exception as e:
        print(e)
        print('Failed on station: ' + str(station))
        return
    with open(fname, 'w') as file_h:
        file_h.write(r.text)

stations = (
    (2057, 'AL'),
    (2078, 'AL'),
    (2177, 'AL'),
    (2113, 'AL'),
    (2174, 'AL'),
    (2055, 'AL'),
    (2173, 'AL'),
    (2180, 'AL'),
    (2114, 'AL'),
    (2178, 'AL'),
    (2181, 'AL'),
    (2182, 'AL'),
    (2176, 'AL'),
    (2056, 'AL'),
    (2179, 'AL'),
    (2115, 'AL'),
    (2175, 'AL'),
    (2053, 'AL'),
    (2065, 'AK'),
    (1232, 'AK'),
    (2213, 'AK'),
    (2210, 'AK'),
    (2211, 'AK'),
    (2208, 'AK'),
    (2212, 'AK'),
    (1233, 'AK'),
    (2062, 'AK'),
    (2209, 'AK'),
    (2081, 'AK'),
    (2063, 'AK'),
    (2080, 'AK'),
    (2221, 'AK'),
    (1234, 'AK'),
    (2026, 'AZ'),
    (2083, 'AR'),
    (2091, 'AR'),
    (2090, 'AR'),
    (2085, 'AR'),
    (2030, 'AR'),
    (2084, 'AR'),
    (2214, 'CA'),
    (2215, 'CA'),
    (2189, 'CA'),
    (2190, 'CA'),
    (2187, 'CA'),
    (2183, 'CA'),
    (2191, 'CA'),
    (2192, 'CA'),
    (2185, 'CA'),
    (2184, 'CA'),
    (2218, 'CA'),
    (2149, 'CA'),
    (2217, 'CA'),
    (2186, 'CA'),
    (2219, 'CA'),
    (2197, 'CO'),
    (2017, 'CO'),
    (2051, 'FL'),
    (2012, 'FL'),
    (2009, 'FL'),
    (2027, 'GA'),
    (2013, 'GA'),
    (2100, 'HI'),
    (2096, 'HI'),
    (2103, 'HI'),
    (2097, 'HI'),
    (2102, 'HI'),
    (2098, 'HI'),
    (2101, 'HI'),
    (2099, 'HI'),
    (2148, 'ID'),
    (674, 'ID'),
    (2004, 'IL'),
    (2031, 'IA'),
    (2068, 'IA'),
    (2092, 'KS'),
    (2094, 'KS'),
    (2147, 'KS'),
    (2093, 'KS'),
    (2079, 'KY'),
    (2005, 'KY'),
    (2049, 'MD'),
    (2002, 'MN'),
    (2050, 'MN'),
    (2032, 'MS'),
    (2024, 'MS'),
    (2025, 'MS'),
    (2110, 'MS'),
    (2087, 'MS'),
    (2033, 'MS'),
    (2046, 'MS'),
    (2109, 'MS'),
    (2070, 'MS'),
    (2086, 'MS'),
    (2064, 'MS'),
    (2082, 'MS'),
    (2034, 'MS'),
    (2035, 'MS'),
    (2195, 'MO'),
    (2048, 'MO'),
    (2220, 'MO'),
    (2194, 'MO'),
    (2060, 'MO'),
    (2061, 'MO'),
    (2193, 'MO'),
    (2047, 'MO'),
    (117, 'MT'),
    (2019, 'MT'),
    (2121, 'MT'),
    (581, 'MT'),
    (2119, 'MT'),
    (2120, 'MT'),
    (808, 'MT'),
    (2118, 'MT'),
    (2111, 'NE'),
    (2001, 'NE'),
    (216, 'NV'),
    (2145, 'NV'),
    (2143, 'NV'),
    (2141, 'NV'),
    (2146, 'NV'),
    (2116, 'NV'),
    (2144, 'NV'),
    (2170, 'NV'),
    (750, 'NV'),
    (2142, 'NV'),
    (2069, 'NH'),
    (2043, 'NH'),
    (2015, 'NM'),
    (2172, 'NM'),
    (2107, 'NM'),
    (2168, 'NM'),
    (2169, 'NM'),
    (2171, 'NM'),
    (2108, 'NM'),
    (2011, 'NY'),
    (2008, 'NC'),
    (2020, 'ND'),
    (2014, 'OH'),
    (2073, 'OH'),
    (2022, 'OK'),
    (2074, 'OR'),
    (2028, 'PA'),
    (2036, 'PA'),
    (2067, 'PR'),
    (2066, 'PR'),
    (2188, 'PR'),
    (2122, 'PR'),
    (2045, 'PR'),
    (2052, 'PR'),
    (15, 'PR'),
    (2112, 'PR'),
    (2037, 'SC'),
    (2038, 'SC'),
    (2072, 'SD'),
    (2076, 'TN'),
    (2077, 'TN'),
    (2075, 'TN'),
    (2207, 'TX'),
    (2006, 'TX'),
    (2206, 'TX'),
    (2201, 'TX'),
    (2106, 'TX'),
    (2105, 'TX'),
    (2016, 'TX'),
    (2104, 'TX'),
    (2199, 'TX'),
    (2200, 'TX'),
    (2203, 'TX'),
    (2204, 'TX'),
    (2202, 'TX'),
    (2205, 'TX'),
    (2138, 'UT'),
    (2135, 'UT'),
    (2151, 'UT'),
    (2136, 'UT'),
    (2161, 'UT'),
    (2150, 'UT'),
    (2125, 'UT'),
    (2167, 'UT'),
    (2130, 'UT'),
    (2128, 'UT'),
    (2126, 'UT'),
    (2165, 'UT'),
    (2152, 'UT'),
    (2131, 'UT'),
    (2160, 'UT'),
    (2164, 'UT'),
    (2166, 'UT'),
    (2127, 'UT'),
    (2155, 'UT'),
    (2156, 'UT'),
    (2140, 'UT'),
    (2129, 'UT'),
    (2133, 'UT'),
    (2134, 'UT'),
    (2137, 'UT'),
    (2157, 'UT'),
    (2153, 'UT'),
    (2132, 'UT'),
    (2159, 'UT'),
    (2154, 'UT'),
    (2158, 'UT'),
    (2163, 'UT'),
    (2162, 'UT'),
    (2139, 'UT'),
    (2042, 'VT'),
    (2041, 'VT'),
    (2123, 'VI'),
    (2039, 'VA'),
    (2089, 'VA'),
    (2088, 'VA'),
    (2040, 'VA'),
    (2198, 'WA'),
    (2021, 'WA'),
    (2196, 'WI'),
    (2003, 'WI'),
    (2018, 'WY')
)

for station in stations:
    print(str(station))
    run(station)
